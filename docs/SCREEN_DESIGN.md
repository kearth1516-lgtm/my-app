# 画面設計書

## 概要
本アプリケーションは、タイマー機能を中心とした時間管理アプリケーションです。ユーザーが学習や運動などの活動時間を記録し、タグで分類して管理できます。

---

## 画面一覧

### 1. ホーム画面 (`/`)
**目的**: アプリケーションのトップページ。メイン機能へのナビゲーション。

#### レイアウト
- **ヘッダー**
  - タイトル: "🏠 マイアプリ"
  - サブタイトル: "趣味を管理しよう"
  - 設定ボタン（⚙️）: 右上に配置、設定画面へ遷移

- **メイン画像エリア**
  - 白い背景のカード
  - ランダムな画像を表示（タイマーに登録された画像からランダム選択）
  - 画像が存在しない場合は「画像を追加してください」メッセージ

- **メニュー**
  - グリッド表示（2列または自動調整）
  - 各メニューアイテムは半透明の白背景
  - アイコン + ラベル形式
  - メニュー項目:
    - ⏱️ タイマー (`/timers`)
    - 🍳 レシピ (`/recipes`) ※準備中
    - 👔 ファッション (`/fashion`) ※準備中

#### スタイル
- 背景: テーマカラーのグラデーション（`var(--theme-gradient)`）
- 文字色: テーマに応じた色（`var(--theme-text-color)`）
- ホバー効果: 上方向に5px移動

---

### 2. タイマー一覧画面 (`/timers`)
**目的**: 登録されたタイマーの一覧表示と管理。

#### レイアウト
- **ヘッダー**
  - タイトル: "⏱️ タイマー"
  - 新規作成ボタン: 右側に配置

- **タイマーカード（グリッド表示）**
  - 1行に3枚まで（レスポンシブ）
  - 各カードの構成:
    - 画像エリア（高さ200px）
    - 編集ボタン（✏️）: 右上
    - 削除ボタン（×）: 右上（ストップウォッチは非表示）
    - タイマー名
    - タイマー表示（MM:SS形式）
    - 操作ボタン:
      - 開始ボタン（緑系、テーマのsuccess色）
      - 停止ボタン（赤系、テーマのdanger色）
    - 統計情報: 「記録回数: X回」

- **底部ナビゲーション**
  - ホームへ戻るボタン

#### 特殊なタイマー
- **ストップウォッチ（固定）**
  - ID: `stopwatch-fixed`
  - デフォルトで存在
  - 削除不可
  - カウントアップ方式（00:00から開始）
  - 編集で画像のみ変更可能

#### 機能
- タイマー開始: カウントダウン/カウントアップ開始、全画面表示へ遷移
- タイマー停止: 記録保存モーダル表示
- タイマー削除: 確認モーダル表示後削除
- タイマー編集: 編集モーダル表示
- カードクリック: 詳細画面へ遷移

#### スタイル
- 背景: テーマカラーのグラデーション
- タイマーカード: 白背景、ホバー時に上方向へ5px移動
- タイマー表示: 等幅フォント、テーマのprimary色

---

### 3. タイマー詳細画面 (`/timers/:id`)
**目的**: 特定のタイマーの詳細情報と記録履歴の表示。

#### レイアウト
- **ヘッダー**
  - 戻るボタン: 左上
  - タイマー名

- **タイマー情報カード**
  - ヒーロー画像（高さ300px）
  - 統計サマリー（グリッド表示）:
    - 総記録回数
    - 総時間
    - 平均時間

- **記録セクション**
  - タイトル: "📝 記録一覧"
  - 記録がない場合: 「まだ記録がありません」メッセージ
  - 記録リスト:
    - 記録番号（円形バッジ、テーマのprimaryグラデーション）
    - 開始時刻・終了時刻
    - 経過時間（大きく強調、テーマのprimary色）
    - タグ（存在する場合）

- **底部ナビゲーション**
  - ホームへ戻る
  - タイマー一覧へ戻る

#### スタイル
- 背景: テーマカラーのグラデーション
- 情報カード: 白背景
- 記録アイテム: グラデーション背景（#f5f7fa → #e8edf3）
- ホバー効果: 右方向へ5px移動

---

### 4. 設定画面 (`/settings`)
**目的**: アプリケーション全体の設定管理。

#### レイアウト
- **ヘッダー**
  - タイトル: "⚙️ 設定"

- **設定コンテンツ**
  - 最大幅800px、中央揃え

- **テーマカラーセクション**
  - セクションタイトル: "テーマカラー"
  - 説明文: "アプリ全体のカラーテーマを選択できます"
  - テーマオプション（グリッド表示）:
    - 12色のテーマ
    - 各オプション:
      - プレビュー（80px高さ、グラデーション表示）
      - テーマ名
      - 選択中の場合: 白い枠線 + チェックマーク（✓）

#### テーマ一覧
| ID | 名前 | 文字色 | 主な用途 |
|---|---|---|---|
| red | レッド | 白 | 情熱的な雰囲気 |
| blue | ブルー | 白 | 落ち着いた雰囲気 |
| yellow | イエロー | 黒 | 明るく活発な雰囲気 |
| green | グリーン | 黒 | 自然で穏やかな雰囲気 |
| pink | ピンク | 黒 | 柔らかく優しい雰囲気 |
| cyan | スカイ | 黒 | 爽やかな雰囲気 |
| orange | オレンジ | 黒 | 元気で活動的な雰囲気 |
| lime | ライム | 黒 | フレッシュな雰囲気 |
| purple | パープル | 白 | 高級感のある雰囲気 |
| black | ブラック | 白 | シックでモダンな雰囲気 |
| white | ホワイト | 黒 | シンプルで清潔な雰囲気 |
| brown | ブラウン | 白 | 温かみのある雰囲気 |

#### テーマカラーパレット構成
各テーマは以下の5色で構成:
- **primary**: メインカラー（明るめ）
- **primaryDark**: メインカラー（濃いめ）
- **accent**: アクセントカラー
- **success**: 成功・開始ボタン用
- **danger**: 警告・停止ボタン用

#### 底部ナビゲーション
- ホームへ戻る

#### 機能
- テーマ選択: クリックで即座にテーマ変更、API保存
- 保存中インジケーター: 画面下部に表示

#### スタイル
- 背景: テーマカラーのグラデーション
- セクション: 半透明の白背景、ぼかし効果
- 文字色: テーマに応じて自動調整

---

## モーダル一覧

### 1. タイマー作成モーダル
**トリガー**: タイマー一覧画面の「新規作成」ボタン

#### 構成
- **ヘッダー**
  - タイトル: "⏱️ 新しいタイマー"
  - 閉じるボタン（×）

- **フォーム**
  - タイマー名（必須）
  - 時間設定:
    - 時（0-23）
    - 分（0-59）
    - 秒（0-59）
  - 画像プレビュー
  - ファイル選択ボタン

- **アクション**
  - キャンセルボタン（半透明の白）
  - 作成ボタン（テーマのprimary→primaryDarkグラデーション）

#### バリデーション
- タイマー名: 必須
- 時間: 最低1秒以上

#### スタイル
- 背景: テーマカラーのグラデーション
- 入力フィールド: 半透明の白背景
- 文字色: テーマに応じて自動調整

---

### 2. タイマー編集モーダル
**トリガー**: タイマーカードの編集ボタン（✏️）

#### 構成
- タイマー作成モーダルと同様のレイアウト
- タイトル: "⏱️ タイマー編集"
- 既存データが入力済み

#### 制約
- **ストップウォッチの場合**: 画像のみ編集可能（名前・時間は変更不可）

#### アクション
- キャンセルボタン
- 更新ボタン（テーマのprimaryグラデーション）

---

### 3. 記録保存モーダル
**トリガー**: タイマー停止時

#### 構成
- **ヘッダー**
  - タイトル: "📝 記録を保存"
  - テーマカラーのグラデーション背景

- **記録情報**
  - タイマー名
  - 経過時間（大きく表示、テーマのprimary色）

- **タグ選択**
  - ラベル: "タグ（任意）"
  - セレクトボックス:
    - "タグなし"（デフォルト）
    - 既存タグのリスト
    - "新しいタグを追加..."
  - 新規タグ入力フィールド（条件表示）

- **アクション**
  - キャンセルボタン
  - 保存ボタン（テーマのprimaryグラデーション）

#### 機能
- タグなしで保存可能
- 新規タグ追加可能（その場で登録）
- タグは全タイマーで共有

---

### 4. 削除確認モーダル
**トリガー**: タイマーカードの削除ボタン（×）

#### 構成
- **ヘッダー**
  - タイトル: "⚠️ 確認"
  - テーマカラーのグラデーション背景

- **メッセージ**
  - 「このタイマーを削除しますか？」
  - タイマー名を表示

- **アクション**
  - キャンセルボタン
  - 削除ボタン（danger用の赤系グラデーション）

---

### 5. タイマー実行中モーダル（全画面）
**トリガー**: タイマー開始ボタン

#### 構成
- **背景**: タイマー画像をぼかして表示
- **タイマー名**: 上部中央に大きく表示
- **タイマー表示**:
  - 中央に大きな円形
  - 進捗リング（カウントダウンの場合のみ）
  - 時間表示（等幅フォント、大きいサイズ）
- **操作ボタン**:
  - 一時停止/再開ボタン（テーマのaccent→primaryグラデーション）
  - 停止ボタン（danger色）
- **開始時刻表示**: 下部に小さく表示

#### 機能
- 一時停止/再開: タイマーの一時停止と再開
- 停止: 記録保存モーダルを表示してタイマー終了
- カウントダウン: 進捗を円形で視覚化
- ストップウォッチ: 00:00から上昇

#### スタイル
- 背景画像: ぼかし + 暗め（brightness 0.6）
- 文字: 白、シャドウ付き
- 円形プログレス: 白いストローク

---

## 共通デザイン要素

### カラーシステム
#### CSS変数
```css
--theme-gradient: テーマのグラデーション背景
--theme-text-color: テーマに応じた文字色（#333 or #fff）
--theme-text-alpha: テーマに応じた半透明文字色
--theme-primary: メインカラー（明るめ）
--theme-primary-dark: メインカラー（濃いめ）
--theme-accent: アクセントカラー
--theme-success: 成功・開始操作用
--theme-danger: 警告・停止操作用
```

#### 適用ルール
- 背景: 全画面でテーマグラデーション使用
- ボタン:
  - 開始系: success色
  - 停止系: danger色
  - 作成/保存系: primary→primaryDarkグラデーション
  - 一時停止系: accent→primaryグラデーション
  - キャンセル系: 半透明の白
- 強調表示: primary色
- 文字色: テーマに応じて自動調整（明るい背景は黒、暗い背景は白）

### タイポグラフィ
- **見出し**: 大きめ、太字
- **本文**: 標準サイズ
- **数値表示**: 等幅フォント（Courier New）、大きめ
- **ラベル**: 小さめ、中太字

### レスポンシブデザイン
- **ブレークポイント**: 768px
- **モバイル対応**:
  - グリッド: 1列表示
  - フォントサイズ: 縮小
  - パディング: 縮小
  - ボタン: 縦並び

### アニメーション
- **フェードイン**: 0.2-0.3秒
- **スライドアップ**: モーダル表示時
- **ホバー効果**: transform + box-shadow
- **トランジション**: 0.2-0.3秒

### 共通コンポーネント
#### 底部ナビゲーション
- 固定位置（bottom: 0）
- 白背景
- シャドウ付き
- 白ベースのボタン（半透明）

#### ボタン
- 角丸: 10-25px
- パディング: 12-14px
- ホバー: 上方向へ2px移動 + シャドウ
- アクティブ: 元の位置に戻る

#### カード
- 白背景
- 角丸: 15-20px
- シャドウ: 0 5px 15px rgba(0,0,0,0.2)
- ホバー: 上方向へ5px移動

---

## データ構造

### Timer
```typescript
{
  id: string;          // 一意なID（ストップウォッチは "stopwatch-fixed"）
  name: string;        // タイマー名
  duration: number;    // 時間（秒）
  type: string;        // "countdown" または "stopwatch"
  image?: string;      // 画像パス（例: "/images/mogu.jpg"）
  records: Record[];   // 記録の配列
  // Cosmos DB内部フィールド（自動生成）
  _rid?: string;       // リソースID
  _self?: string;      // セルフリンク
  _etag?: string;      // ETag
  _attachments?: string; // アタッチメント
  _ts?: number;        // タイムスタンプ
}
```

### Record
```typescript
{
  startTime: string;   // 開始時刻（ISO 8601形式）
  endTime: string;     // 終了時刻（ISO 8601形式）
  duration: number;    // 経過時間（秒）
  date: string;        // 日付（YYYY-MM-DD）
  tag?: string;        // タグ（オプション）
}
```

### Settings
```typescript
{
  id: string;          // 固定値: "app-settings"
  theme: string;       // テーマID（例: "purple", "blue"）
  // Cosmos DB内部フィールド（自動生成）
  _rid?: string;
  _self?: string;
  _etag?: string;
  _attachments?: string;
  _ts?: number;
}
```

### Tag
```typescript
{
  id: string;          // タグ名をそのままIDとして使用
  name: string;        // タグ名
  // Cosmos DB内部フィールド（自動生成）
  _rid?: string;
  _self?: string;
  _etag?: string;
  _attachments?: string;
  _ts?: number;
}
```

---

## API エンドポイント

### タイマー
- `GET /api/timers`: 全タイマー取得
- `POST /api/timers`: タイマー作成
- `PUT /api/timers/:id`: タイマー更新
- `DELETE /api/timers/:id`: タイマー削除
- `POST /api/timers/:id/start`: タイマー開始
- `POST /api/timers/:id/stop`: タイマー停止（記録保存）

### タグ
- `GET /api/timers/tags/all`: 全タグ取得
- `POST /api/timers/tags`: タグ作成

### 設定
- `GET /api/settings`: 設定取得
- `PUT /api/settings`: 設定更新

### 画像
- `POST /api/upload`: 画像アップロード

---

## ユーザーフロー

### タイマー作成 → 実行 → 記録保存
1. タイマー一覧画面で「新規作成」クリック
2. タイマー作成モーダルで名前・時間・画像を設定
3. 「作成」クリックでタイマー追加
4. タイマーカードの「開始」ボタンクリック
5. 全画面タイマー実行モーダル表示
6. タイマー終了後「停止」ボタンクリック
7. 記録保存モーダルでタグ選択（任意）
8. 「保存」クリックで記録追加
9. タイマー一覧画面に戻る

### 記録確認
1. タイマー一覧画面でタイマーカードクリック
2. タイマー詳細画面で記録一覧表示
3. 統計情報と個別記録を確認

### テーマ変更
1. ホーム画面で設定ボタン（⚙️）クリック
2. 設定画面でテーマカラーを選択
3. 即座にアプリ全体のテーマが変更
4. ホームに戻って変更を確認

---

## 今後の拡張予定
- レシピ管理機能
- ファッション管理機能
- 記録のグラフ表示（日別・週別・月別）
- タグごとの集計・統計
- 認証機能
- データのエクスポート/インポート機能

---

## 技術スタック
- **フロントエンド**: React 18, TypeScript, Vite 7.2.2, React Router DOM, Axios
- **バックエンド**: FastAPI 0.104.1, Python 3.12, Uvicorn
- **データベース**: Azure Cosmos DB for NoSQL（サーバーレスモード）
  - エンドポイント: my-app-cosmosdb-1516.documents.azure.com
  - データベース名: my-app-db
  - コンテナ: timers, tags, settings（パーティションキー: /id）
  - リージョン: Japan East
- **スタイリング**: CSS（CSS Variables使用）
- **状態管理**: React Hooks（useState, useEffect）
- **環境変数管理**: python-dotenv
